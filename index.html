<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="src/styles/styles.css">
    <title>Projeto RPG</title>
    <style>
        /* Adiciona estilo para o chat */
        #chat {
            height: 300px; /* Define a altura fixa */
            border: 1px solid #ccc;
            padding: 10px;
            overflow-y: auto; /* Permite rolagem vertical */
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }
        .message {
            margin: 5px 0;
        }
        .mestre {
            font-weight: bold;
        }
    </style>
</head>

<body>
    
    <div id="container">
        <div class="tab-buttons">
            
            <button class="tab-btn active" content-id="ficha">
                Ficha RPG
            </button>

            <button class="tab-btn" content-id="services">
              Chat
            </button>

        </div>

        <div class="tab-contents">
            <div class="content" id="ficha">
                

                <div class="infos">
                    <h1 class="content-title">
                        Ficha do RPG
                    </h1>

                    <p class="content-description">
                        <form action="ficha.php" method="POST">
                            <div class="textfield">
                                <label for="player_name">Nome do Jogador:</label>
                                <input type="text" id="player_name" name="player_name" required>
                            </div>
                            <div class="textfield">
                                <label for="character_name">Nome do Personagem:</label>
                                <input type="text" id="character_name" name="character_name" required>
                            </div>
                            <div class="textfield">
                                <label for="age">Idade:</label>
                                <input type="number" id="age" name="age" required>
                            </div>
                            <div class="textfield">
                                <label for="class">Classe:</label>
                                <select id="class" name="class" required>
                                    <option value="" disabled selected>Selecione uma classe</option>
                                    <option value="Guerreiro">Guerreiro</option>
                                    <option value="Mago">Mago</option>
                                    <option value="Ladrão">Ladrão</option>
                                    <option value="Clérigo">Clérigo</option>
                                    <option value="Arqueiro">Arqueiro</option>
                                </select>
                            </div>
                            <div class="textfield">
                                <label for="race">Raça:</label>
                                <select id="race" name="race" required>
                                    <option value="" disabled selected>Selecione uma raça</option>
                                    <option value="Humano">Humano</option>
                                    <option value="Elfo">Elfo</option>
                                    <option value="Anão">Anão</option>
                                    <option value="Orc">Orc</option>
                                    <option value="Meio-Elfo">Meio-Elfo</option>
                                </select>
                            </div>
                            <div class="textfield">
                                <label for="background">Background:</label>
                                <textarea id="background" name="background" rows="3" required></textarea>
                            </div>
                            <div class="textfield">
                                <label for="status">Atributos:</label>
                                <label for="forca">Força (STR):</label>
                                <input type="number" id="forca" name="forca" min="0" max="20" value="10">

                                <label for="destreza">Destreza (DEX):</label>
                                <input type="number" id="destreza" name="destreza" min="0" max="20" value="10">

                                <label for="constituicao">Constituição (CON):</label>
                                <input type="number" id="constituicao" name="constituicao" min="0" max="20" value="10">

                                <label for="inteligencia">Inteligência (INT):</label>
                                <input type="number" id="inteligencia" name="inteligencia" min="0" max="20" value="10">

                                <label for="sabedoria">Sabedoria (WIS):</label>
                                <input type="number" id="sabedoria" name="sabedoria" min="0" max="20" value="10">

                                <label for="carisma">Carisma (CHA):</label>
                                <input type="number" id="carisma" name="carisma" min="0" max="20" value="10">

                            </div>
                            <div class="textfield">
                                <label for="equipment">Equipamento:</label>
                                <textarea id="equipment" name="equipment" rows="3"></textarea>
                            </div>
                            <div class="textfield">
                                <label for="notes">Anotações:</label>
                                <textarea id="notes" name="notes" rows="3"></textarea>
                            </div>
                            <button type="submit" class="btn-save">Salvar Ficha</button>
                        </form>
                    </p>
                </div>
            </div>

            <div class="content" id="services">
                
                <div class="infos">
                    <!-- Chat Privado RPG -->
                    <div class="chat-section">
                        <h1>Chat Privado RPG</h1>
                        
                        <label for="nickname">Nickname:</label>
                        <input id="nickname" placeholder="Seu nickname" />
                        
                        <label for="role">Você é:</label>
                        <select id="role">
                            <option value="player">Player</option>
                            <option value="mestre">Mestre</option>
                        </select>

                        <label for="color">Escolha a cor do seu nickname:</label>
                        <input type="color" id="color" value="#000000" />

                        <div id="chat"></div>
                        
                        <input id="message" autocomplete="off" placeholder="Digite sua mensagem" />
                        <button id="send">Enviar</button>

                        <script>
                            const socket = io();
                            
                            const chat = document.getElementById('chat');
                            const messageInput = document.getElementById('message');
                            const sendButton = document.getElementById('send');
                            const nicknameInput = document.getElementById('nickname');
                            const roleSelect = document.getElementById('role');
                            const colorInput = document.getElementById('color');

                            sendButton.onclick = () => {
                                const nickname = nicknameInput.value || 'Anônimo';
                                const role = roleSelect.value;
                                const message = messageInput.value;
                                const color = colorInput.value;

                                if (message) {
                                    const formattedMessage = {
                                        text: message,
                                        nickname: nickname,
                                        role: role,
                                        color: color
                                    };
                                    socket.emit('private message', formattedMessage);
                                    messageInput.value = '';
                                }
                            };

                            socket.on('private message', (msg) => {
                                const newMessage = document.createElement('div');
                                newMessage.className = 'message ' + (msg.role === 'mestre' ? 'mestre' : 'player');
                                newMessage.style.color = msg.color; // Aplica a cor escolhida ao nickname
                                newMessage.textContent = `${msg.nickname} (${msg.role}): ${msg.text}`;
                                chat.appendChild(newMessage);
                                chat.scrollTop = chat.scrollHeight; // Rola para a última mensagem
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="src/javascript/script.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</body>
</html>
